<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Provider Documentation</title>
<style>
/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.css);
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #6c818f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #444444; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #111111; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: ff-meta-web-pro-1, ff-meta-web-pro-2, Arial, "Helvetica Neue", sans-serif; font-weight: bold; font-style: normal; color: #465158; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #909ea7; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Consolas", "Deja Vu Sans Mono", "Bitstream Vera Sans Mono", monospace; font-weight: normal; color: #444444; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 0; }
ul.no-bullet, ol.no-bullet { margin-left: 0; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #748590; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #748590; }

blockquote, blockquote p { line-height: 1.5; color: #909ea7; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 0 #dddddd; }
table thead, table tfoot { background: none; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 1px 8px 1px 5px; font-size: 1em; color: #222222; text-align: left; }
table tr th, table tr td { padding: 1px 8px 1px 5px; font-size: 1em; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: none; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.5; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.95em; padding: 0; white-space: nowrap; background-color: #f2f2f2; border: 0 solid #dddddd; -webkit-border-radius: 6px; border-radius: 6px; text-shadow: none; }

pre, pre > code { line-height: 1.2; color: inherit; font-family: "Consolas", "Deja Vu Sans Mono", "Bitstream Vera Sans Mono", monospace; font-weight: normal; }

.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: #373737; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #111111; font-weight: bold; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #909ea7; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #6c818f; }

@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 6px; border-radius: 6px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: ff-meta-web-pro-1, ff-meta-web-pro-2, Arial, "Helvetica Neue", sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: black; padding: 1.25em; }

#footer-text { color: white; line-height: 1.35; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #465158; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #3b444a; }

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #909ea7; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 6px; border-radius: 6px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 6px; border-radius: 6px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #6c818f; margin-top: 0; line-height: 1.5; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre:not([class]), .listingblock pre:not([class]) { background: #eeeeee; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px; border-style: solid; border-color: #cccccc; -webkit-border-radius: 6px; border-radius: 6px; padding: 0.5em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.76em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.855em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.95em; } }

.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 0.5em; }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #748590; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 6px; border-radius: 6px; border-top: 0 solid #dddddd; border-bottom: 0 solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

tbody tr th { display: table-cell; line-height: 1.5; background: none; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 0.25em; }

ul li ol { margin-left: 0; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #373737; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #444444; color: #333333; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

.listingblock code { white-space: pre; overflow: auto; overflow-wrap: normal; /* needed for webkit browsers */ }

#toc ul.sectlevel0 > li > a { font-style: normal; font-weight: bold; }

h4 { color: #6c818f; }

.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 6px; border-radius: 6px; margin-left: 2em; margin-right: 2em; }

.admonitionblock { margin-left: 2em; margin-right: 2em; }
.admonitionblock > table { border: 1px solid #609060; border-top-width: 1.5em; background-color: #e9ffe9; border-collapse: separate; -webkit-border-radius: 0; border-radius: 0; }
.admonitionblock > table td.icon { padding-top: .5em; padding-bottom: .5em; }
.admonitionblock > table td.content { padding: .5em 1em; color: black; font-size: .9em; border-left: none; }

.sidebarblock { background-color: #e8ecef; border-color: #ccc; }
.sidebarblock > .content > .title { color: #444444; }

table.tableblock.grid-all { border-collapse: collapse; -webkit-border-radius: 0; border-radius: 0; }
table.tableblock.grid-all th.tableblock, table.tableblock.grid-all td.tableblock { border-bottom: 1px solid #aaa; }

#footer { background-color: #465158; padding: 2em; }

#footer-text { color: #eee; font-size: 0.8em; text-align: center; }

.invisible {position: absolute; left: 9999px}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_provider_documentation">Provider Documentation</a>
<ul class="sectlevel1">
<li><a href="#graph-system-provider-requirements">Graph System Provider Requirements</a>
<ul class="sectlevel2">
<li><a href="#_implementing_gremlin_core">Implementing Gremlin-Core</a>
<ul class="sectlevel3">
<li><a href="#oltp-implementations">OLTP Implementations</a></li>
<li><a href="#olap-implementations">OLAP Implementations</a></li>
<li><a href="#_hadoop_gremlin_usage">Hadoop-Gremlin Usage</a></li>
<li><a href="#io-implementations">IO Implementations</a></li>
<li><a href="#remoteconnection-implementations">RemoteConnection Implementations</a></li>
</ul>
</li>
<li><a href="#validating-with-gremlin-test">Validating with Gremlin-Test</a></li>
<li><a href="#_accessibility_via_gremlinplugin">Accessibility via GremlinPlugin</a></li>
<li><a href="#_in_depth_implementations">In-Depth Implementations</a></li>
</ul>
</li>
<li><a href="#_graph_driver_provider_requirements">Graph Driver Provider Requirements</a>
<ul class="sectlevel2">
<li><a href="#_opprocessors_arguments">OpProcessors Arguments</a>
<ul class="sectlevel3">
<li><a href="#_common">Common</a></li>
<li><a href="#_standard_opprocessor">Standard OpProcessor</a></li>
<li><a href="#_session_opprocessor">Session OpProcessor</a></li>
<li><a href="#_traversal_opprocessor">Traversal OpProcessor</a></li>
</ul>
</li>
<li><a href="#_authentication">Authentication</a></li>
</ul>
</li>
<li><a href="#gremlin-plugins">Gremlin Plugins</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="http://tinkerpop.apache.org"><img src="../../images/apache-tinkerpop-logo.png" alt="apache tinkerpop logo" width="500"></a>
</div>
</div>
<div class="paragraph">
<p><strong>3.3.1</strong></p>
</div>
</div>
</div>
<h1 id="_provider_documentation" class="sect0">Provider Documentation</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>TinkerPop exposes a set of interfaces, protocols, and tests that make it possible for third-parties to build libraries
and systems that plug-in to the TinkerPop stack.  TinkerPop refers to those third-parties as "providers" and this
documentation is designed to help providers understand what is involved in developing code on these lower levels of
the TinkerPop API.</p>
</div>
<div class="paragraph">
<p>This document attempts to address the needs of the different providers that have been identified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Graph System Provider</p>
<div class="ulist">
<ul>
<li>
<p>Graph Database Provider</p>
</li>
<li>
<p>Graph Processor Provider</p>
</li>
</ul>
</div>
</li>
<li>
<p>Graph Driver Provider</p>
</li>
<li>
<p>Graph Language Provider</p>
</li>
<li>
<p>Graph Plugin Provider</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="graph-system-provider-requirements">Graph System Provider Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image" style="float: left"><img src="../../images/tinkerpop-enabled.png" alt="tinkerpop enabled" width="140"></span> At the core of TinkerPop3 is a Java8 API. The implementation of this
core API and its validation via the <code>gremlin-test</code> suite is all that is required of a graph system provider wishing to
provide a TinkerPop3-enabled graph engine. Once a graph system has a valid implementation, then all the applications
provided by TinkerPop (e.g. Gremlin Console, Gremlin Server, etc.) and 3rd-party developers (e.g. Gremlin-Scala,
Gremlin-JS, etc.) will integrate properly. Finally, please feel free to use the logo on the left to promote your
TinkerPop3 implementation.</p>
</div>
<div class="sect2">
<h3 id="_implementing_gremlin_core">Implementing Gremlin-Core</h3>
<div class="paragraph">
<p>The classes that a graph system provider should focus on implementing are itemized below. It is a good idea to study
the <a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#tinkergraph-gremlin">TinkerGraph</a> (in-memory OLTP and OLAP
in <code>tinkergraph-gremlin</code>), <a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#neo4j-gremlin">Neo4jGraph</a>
(OLTP w/ transactions in <code>neo4j-gremlin</code>) and/or
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#hadoop-gremlin">HadoopGraph</a> (OLAP in <code>hadoop-gremlin</code>)
implementations for ideas and patterns.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Online Transactional Processing Graph Systems (<strong>OLTP</strong>)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Structure API: <code>Graph</code>, <code>Element</code>, <code>Vertex</code>, <code>Edge</code>, <code>Property</code> and <code>Transaction</code> (if transactions are supported).</p>
</li>
<li>
<p>Process API: <code>TraversalStrategy</code> instances for optimizing Gremlin traversals to the provider&#8217;s graph system (i.e. <code>TinkerGraphStepStrategy</code>).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Online Analytics Processing Graph Systems (<strong>OLAP</strong>)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Everything required of OLTP is required of OLAP (but not vice versa).</p>
</li>
<li>
<p>GraphComputer API: <code>GraphComputer</code>, <code>Messenger</code>, <code>Memory</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Please consider the following implementation notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be sure your <code>Graph</code> implementation is named as <code>XXXGraph</code> (e.g. TinkerGraph, Neo4jGraph, HadoopGraph, etc.).</p>
</li>
<li>
<p>Use <code>StringHelper</code> to ensuring that the <code>toString()</code> representation of classes are consistent with other implementations.</p>
</li>
<li>
<p>Ensure that your implementation&#8217;s <code>Features</code> (Graph, Vertex, etc.) are correct so that test cases handle particulars accordingly.</p>
</li>
<li>
<p>Use the numerous static method helper classes such as <code>ElementHelper</code>, <code>GraphComputerHelper</code>, <code>VertexProgramHelper</code>, etc.</p>
</li>
<li>
<p>There are a number of default methods on the provided interfaces that are semantically correct. However, if they are
not efficient for the implementation, override them.</p>
</li>
<li>
<p>Implement the <code>structure/</code> package interfaces first and then, if desired, interfaces in the <code>process/</code> package interfaces.</p>
</li>
<li>
<p><code>ComputerGraph</code> is a <code>Wrapper</code> system that ensure proper semantics during a GraphComputer computation.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="oltp-implementations">OLTP Implementations</h4>
<div class="paragraph">
<p><span class="image" style="float: right"><img src="../../images/pipes-character-1.png" alt="pipes character 1" width="110"></span> The most important interfaces to implement are in the <code>structure/</code>
package. These include interfaces like Graph, Vertex, Edge, Property, Transaction, etc. The <code>StructureStandardSuite</code>
will ensure that the semantics of the methods implemented are correct. Moreover, there are numerous <code>Exceptions</code>
classes with static exceptions that should be thrown by the graph system so that all the exceptions and their
messages are consistent amongst all TinkerPop3 implementations.</p>
</div>
</div>
<div class="sect3">
<h4 id="olap-implementations">OLAP Implementations</h4>
<div class="paragraph">
<p><span class="image" style="float: right"><img src="../../images/furnace-character-1.png" alt="furnace character 1" width="110"></span> Implementing the OLAP interfaces may be a bit more complicated.
Note that before OLAP interfaces are implemented, it is necessary for the OLTP interfaces to be, at minimal,
implemented as specified in <a href="#oltp-implementations">OLTP Implementations</a>. A summary of each required interface
implementation is presented below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>GraphComputer</code>: A fluent builder for specifying an isolation level, a VertexProgram, and any number of MapReduce jobs to be submitted.</p>
</li>
<li>
<p><code>Memory</code>: A global blackboard for ANDing, ORing, INCRing, and SETing values for specified keys.</p>
</li>
<li>
<p><code>Messenger</code>: The system that collects and distributes messages being propagated by vertices executing the VertexProgram application.</p>
</li>
<li>
<p><code>MapReduce.MapEmitter</code>: The system that collects key/value pairs being emitted by the MapReduce applications map-phase.</p>
</li>
<li>
<p><code>MapReduce.ReduceEmitter</code>: The system that collects key/value pairs being emitted by the MapReduce applications combine- and reduce-phases.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The VertexProgram and MapReduce interfaces in the <code>process/computer/</code> package are not required by the graph
system. Instead, these are interfaces to be implemented by application developers writing VertexPrograms and MapReduce jobs.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
TinkerPop3 provides three OLAP implementations:
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#tinkergraph-gremlin">TinkerGraphComputer</a> (TinkerGraph),
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#giraphgraphcomputer">GiraphGraphComputer</a> (HadoopGraph), and
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#sparkgraphcomputer">SparkGraphComputer</a> (Hadoop).
Given the complexity of the OLAP system, it is good to study and copy many of the patterns used in these reference
implementations.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_implementing_graphcomputer">Implementing GraphComputer</h5>
<div class="paragraph">
<p><span class="image" style="float: right"><img src="../../images/furnace-character-3.png" alt="furnace character 3" width="150"></span> The most complex method in GraphComputer is the <code>submit()</code>-method. The method must do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure the GraphComputer has not already been executed.</p>
</li>
<li>
<p>Ensure that at least there is a VertexProgram or 1 MapReduce job.</p>
</li>
<li>
<p>If there is a VertexProgram, validate that it can execute on the GraphComputer given the respectively defined features.</p>
</li>
<li>
<p>Create the Memory to be used for the computation.</p>
</li>
<li>
<p>Execute the VertexProgram.setup() method once and only once.</p>
</li>
<li>
<p>Execute the VertexProgram.execute() method for each vertex.</p>
</li>
<li>
<p>Execute the VertexProgram.terminate() method once and if true, repeat VertexProgram.execute().</p>
</li>
<li>
<p>When VertexProgram.terminate() returns true, move to MapReduce job execution.</p>
</li>
<li>
<p>MapReduce jobs are not required to be executed in any specified order.</p>
</li>
<li>
<p>For each Vertex, execute MapReduce.map(). Then (if defined) execute MapReduce.combine() and MapReduce.reduce().</p>
</li>
<li>
<p>Update Memory with runtime information.</p>
</li>
<li>
<p>Construct a new <code>ComputerResult</code> containing the compute Graph and Memory.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_implementing_memory">Implementing Memory</h5>
<div class="paragraph">
<p><span class="image" style="float: left"><img src="../../images/gremlin-brain.png" alt="gremlin brain" width="175"></span> The Memory object is initially defined by <code>VertexProgram.setup()</code>.
The memory data is available in the first round of the <code>VertexProgram.execute()</code> method. Each Vertex, when executing
the VertexProgram, can update the Memory in its round. However, the update is not seen by the other vertices until
the next round. At the end of the first round, all the updates are aggregated and the new memory data is available
on the second round. This process repeats until the VertexProgram terminates.</p>
</div>
</div>
<div class="sect4">
<h5 id="_implementing_messenger">Implementing Messenger</h5>
<div class="paragraph">
<p>The Messenger object is similar to the Memory object in that a vertex can read and write to the Messenger. However,
the data it reads are the messages sent to the vertex in the previous step and the data it writes are the messages
that will be readable by the receiving vertices in the subsequent round.</p>
</div>
</div>
<div class="sect4">
<h5 id="_implementing_mapreduce_emitters">Implementing MapReduce Emitters</h5>
<div class="paragraph">
<p><span class="image" style="float: left"><img src="../../images/hadoop-logo-notext.png" alt="hadoop logo notext" width="150"></span> The MapReduce framework in TinkerPop3 is similar to the model
popularized by <a href="http://hadoop.apache.org">Hadoop</a>. The primary difference is that all Mappers process the vertices
of the graph, not an arbitrary key/value pair. However, the vertices' edges can not be accessed&#8201;&#8212;&#8201;only their
properties. This greatly reduces the amount of data needed to be pushed through the MapReduce engine as any edge
information required, can be computed in the VertexProgram.execute() method. Moreover, at this stage, vertices can
not be mutated, only their token and property data read. A Gremlin OLAP system needs to provide implementations for
to particular classes: <code>MapReduce.MapEmitter</code> and <code>MapReduce.ReduceEmitter</code>. TinkerGraph&#8217;s implementation is provided
below which demonstrates the simplicity of the algorithm (especially when the data is all within the same JVM).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TinkerMapEmitter</span>&lt;K, V&gt; <span class="directive">implements</span> MapReduce.MapEmitter&lt;K, V&gt; {

    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;K, <span class="predefined-type">Queue</span>&lt;V&gt;&gt; reduceMap;
    <span class="directive">public</span> <span class="predefined-type">Queue</span>&lt;KeyValue&lt;K, V&gt;&gt; mapQueue;
    <span class="directive">private</span> <span class="directive">final</span> <span class="type">boolean</span> doReduce;

    <span class="directive">public</span> TinkerMapEmitter(<span class="directive">final</span> <span class="type">boolean</span> doReduce) { <span class="invisible">//</span><b class="conum">1</b>
        <span class="local-variable">this</span>.doReduce = doReduce;
        <span class="keyword">if</span> (<span class="local-variable">this</span>.doReduce)
            <span class="local-variable">this</span>.reduceMap = <span class="keyword">new</span> <span class="predefined-type">ConcurrentHashMap</span>&lt;&gt;();
        <span class="keyword">else</span>
            <span class="local-variable">this</span>.mapQueue = <span class="keyword">new</span> <span class="predefined-type">ConcurrentLinkedQueue</span>&lt;&gt;();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> emit(K key, V value) {
        <span class="keyword">if</span> (<span class="local-variable">this</span>.doReduce)
            <span class="local-variable">this</span>.reduceMap.computeIfAbsent(key, k -&gt; <span class="keyword">new</span> <span class="predefined-type">ConcurrentLinkedQueue</span>&lt;&gt;()).add(value); <span class="invisible">//</span><b class="conum">2</b>
        <span class="keyword">else</span>
            <span class="local-variable">this</span>.mapQueue.add(<span class="keyword">new</span> KeyValue&lt;&gt;(key, value)); <span class="invisible">//</span><b class="conum">3</b>
    }

    <span class="directive">protected</span> <span class="type">void</span> complete(<span class="directive">final</span> MapReduce&lt;K, V, ?, ?, ?&gt; mapReduce) {
        <span class="keyword">if</span> (!<span class="local-variable">this</span>.doReduce &amp;&amp; mapReduce.getMapKeySort().isPresent()) { <span class="invisible">//</span><b class="conum">4</b>
            <span class="directive">final</span> <span class="predefined-type">Comparator</span>&lt;K&gt; comparator = mapReduce.getMapKeySort().get();
            <span class="directive">final</span> <span class="predefined-type">List</span>&lt;KeyValue&lt;K, V&gt;&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;(<span class="local-variable">this</span>.mapQueue);
            <span class="predefined-type">Collections</span>.sort(list, <span class="predefined-type">Comparator</span>.comparing(KeyValue::getKey, comparator));
            <span class="local-variable">this</span>.mapQueue.clear();
            <span class="local-variable">this</span>.mapQueue.addAll(list);
        } <span class="keyword">else</span> <span class="keyword">if</span> (mapReduce.getMapKeySort().isPresent()) {
            <span class="directive">final</span> <span class="predefined-type">Comparator</span>&lt;K&gt; comparator = mapReduce.getMapKeySort().get();
            <span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>.Entry&lt;K, <span class="predefined-type">Queue</span>&lt;V&gt;&gt;&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
            list.addAll(<span class="local-variable">this</span>.reduceMap.entrySet());
            <span class="predefined-type">Collections</span>.sort(list, <span class="predefined-type">Comparator</span>.comparing(<span class="predefined-type">Map</span>.Entry::getKey, comparator));
            <span class="local-variable">this</span>.reduceMap = <span class="keyword">new</span> <span class="predefined-type">LinkedHashMap</span>&lt;&gt;();
            list.forEach(entry -&gt; <span class="local-variable">this</span>.reduceMap.put(entry.getKey(), entry.getValue()));
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>If the MapReduce job has a reduce, then use one data structure (<code>reduceMap</code>), else use another (<code>mapList</code>). The
difference being that a reduction requires a grouping by key and therefore, the <code>Map&lt;K,Queue&lt;V&gt;&gt;</code> definition. If no
reduction/grouping is required, then a simple <code>Queue&lt;KeyValue&lt;K,V&gt;&gt;</code> can be leveraged.</p>
</li>
<li>
<p>If reduce is to follow, then increment the Map with a new value for the key. <code>MapHelper</code> is a TinkerPop3 class
with static methods for adding data to a Map.</p>
</li>
<li>
<p>If no reduce is to follow, then simply append a KeyValue to the queue.</p>
</li>
<li>
<p>When the map phase is complete, any map-result sorting required can be executed at this point.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TinkerReduceEmitter</span>&lt;OK, OV&gt; <span class="directive">implements</span> MapReduce.ReduceEmitter&lt;OK, OV&gt; {

    <span class="directive">protected</span> <span class="predefined-type">Queue</span>&lt;KeyValue&lt;OK, OV&gt;&gt; reduceQueue = <span class="keyword">new</span> <span class="predefined-type">ConcurrentLinkedQueue</span>&lt;&gt;();

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> emit(<span class="directive">final</span> OK key, <span class="directive">final</span> OV value) {
        <span class="local-variable">this</span>.reduceQueue.add(<span class="keyword">new</span> KeyValue&lt;&gt;(key, value));
    }

    <span class="directive">protected</span> <span class="type">void</span> complete(<span class="directive">final</span> MapReduce&lt;?, ?, OK, OV, ?&gt; mapReduce) {
        <span class="keyword">if</span> (mapReduce.getReduceKeySort().isPresent()) {
            <span class="directive">final</span> <span class="predefined-type">Comparator</span>&lt;OK&gt; comparator = mapReduce.getReduceKeySort().get();
            <span class="directive">final</span> <span class="predefined-type">List</span>&lt;KeyValue&lt;OK, OV&gt;&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;(<span class="local-variable">this</span>.reduceQueue);
            <span class="predefined-type">Collections</span>.sort(list, <span class="predefined-type">Comparator</span>.comparing(KeyValue::getKey, comparator));
            <span class="local-variable">this</span>.reduceQueue.clear();
            <span class="local-variable">this</span>.reduceQueue.addAll(list);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>MapReduce.reduce()</code> is defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> reduce(<span class="directive">final</span> OK key, <span class="directive">final</span> <span class="predefined-type">Iterator</span>&lt;OV&gt; values, <span class="directive">final</span> ReduceEmitter&lt;OK, OV&gt; emitter) { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In other words, for the TinkerGraph implementation, iterate through the entrySet of the <code>reduceMap</code> and call the
<code>reduce()</code> method on each entry. The <code>reduce()</code> method can emit key/value pairs which are simply aggregated into a
<code>Queue&lt;KeyValue&lt;OK,OV&gt;&gt;</code> in an analogous fashion to <code>TinkerMapEmitter</code> when no reduce is to follow. These two emitters
are tied together in <code>TinkerGraphComputer.submit()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
for (<span class="directive">final</span> MapReduce mapReduce : mapReducers) {
    <span class="keyword">if</span> (mapReduce.doStage(MapReduce.Stage.MAP)) {
        <span class="directive">final</span> TinkerMapEmitter&lt;?, ?&gt; mapEmitter = <span class="keyword">new</span> TinkerMapEmitter&lt;&gt;(mapReduce.doStage(MapReduce.Stage.REDUCE));
        <span class="directive">final</span> SynchronizedIterator&lt;Vertex&gt; vertices = <span class="keyword">new</span> SynchronizedIterator&lt;&gt;(<span class="local-variable">this</span>.graph.vertices());
        workers.setMapReduce(mapReduce);
        workers.mapReduceWorkerStart(MapReduce.Stage.MAP);
        workers.executeMapReduce(workerMapReduce -&gt; {
            <span class="keyword">while</span> (<span class="predefined-constant">true</span>) {
                <span class="directive">final</span> Vertex vertex = vertices.next();
                <span class="keyword">if</span> (<span class="predefined-constant">null</span> == vertex) <span class="keyword">return</span>;
                workerMapReduce.map(ComputerGraph.mapReduce(vertex), mapEmitter);
            }
        });
        workers.mapReduceWorkerEnd(MapReduce.Stage.MAP);

        <span class="comment">// sort results if a map output sort is defined</span>
        mapEmitter.complete(mapReduce);

        <span class="comment">// no need to run combiners as this is single machine</span>
        <span class="keyword">if</span> (mapReduce.doStage(MapReduce.Stage.REDUCE)) {
            <span class="directive">final</span> TinkerReduceEmitter&lt;?, ?&gt; reduceEmitter = <span class="keyword">new</span> TinkerReduceEmitter&lt;&gt;();
            <span class="directive">final</span> SynchronizedIterator&lt;<span class="predefined-type">Map</span>.Entry&lt;?, <span class="predefined-type">Queue</span>&lt;?&gt;&gt;&gt; keyValues = <span class="keyword">new</span> SynchronizedIterator((<span class="predefined-type">Iterator</span>) mapEmitter.reduceMap.entrySet().iterator());
            workers.mapReduceWorkerStart(MapReduce.Stage.REDUCE);
            workers.executeMapReduce(workerMapReduce -&gt; {
                <span class="keyword">while</span> (<span class="predefined-constant">true</span>) {
                    <span class="directive">final</span> <span class="predefined-type">Map</span>.Entry&lt;?, <span class="predefined-type">Queue</span>&lt;?&gt;&gt; entry = keyValues.next();
                    <span class="keyword">if</span> (<span class="predefined-constant">null</span> == entry) <span class="keyword">return</span>;
                        workerMapReduce.reduce(entry.getKey(), entry.getValue().iterator(), reduceEmitter);
                    }
                });
            workers.mapReduceWorkerEnd(MapReduce.Stage.REDUCE);
            reduceEmitter.complete(mapReduce); <span class="comment">// sort results if a reduce output sort is defined</span>
            mapReduce.addResultToMemory(<span class="local-variable">this</span>.memory, reduceEmitter.reduceQueue.iterator()); <span class="invisible">//</span><b class="conum">1</b>
        } <span class="keyword">else</span> {
            mapReduce.addResultToMemory(<span class="local-variable">this</span>.memory, mapEmitter.mapQueue.iterator()); <span class="invisible">//</span><b class="conum">2</b>
        }
    }
}
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Note that the final results of the reducer are provided to the Memory as specified by the application developer&#8217;s
<code>MapReduce.addResultToMemory()</code> implementation.</p>
</li>
<li>
<p>If there is no reduce stage, the map-stage results are inserted into Memory as specified by the application
developer&#8217;s <code>MapReduce.addResultToMemory()</code> implementation.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hadoop_gremlin_usage">Hadoop-Gremlin Usage</h4>
<div class="paragraph">
<p>Hadoop-Gremlin is centered around <code>InputFormats</code> and <code>OutputFormats</code>. If a 3rd-party graph system provider wishes to
leverage Hadoop-Gremlin (and its respective <code>GraphComputer</code> engines), then they need to provide, at minimum, a
Hadoop2 <code>InputFormat&lt;NullWritable,VertexWritable&gt;</code> for their graph system. If the provider wishes to persist computed
results back to their graph system (and not just to HDFS via a <code>FileOutputFormat</code>), then a graph system specific
<code>OutputFormat&lt;NullWritable,VertexWritable&gt;</code> must be developed as well.</p>
</div>
<div class="paragraph">
<p>Conceptually, <code>HadoopGraph</code> is a wrapper around a <code>Configuration</code> object. There is no "data" in the <code>HadoopGraph</code> as
the <code>InputFormat</code> specifies where and how to get the graph data at OLAP (and OLTP) runtime. Thus, <code>HadoopGraph</code> is a
small object with little overhead. Graph system providers should realize <code>HadoopGraph</code> as the gateway to the OLAP
features offered by Hadoop-Gremlin. For example, a graph system specific <code>Graph.compute(Class&lt;? extends GraphComputer&gt;
graphComputerClass)</code>-method may look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> &lt;C <span class="directive">extends</span> GraphComputer&gt; C compute(<span class="directive">final</span> <span class="predefined-type">Class</span>&lt;C&gt; graphComputerClass) <span class="directive">throws</span> <span class="exception">IllegalArgumentException</span> {
  <span class="keyword">try</span> {
    <span class="keyword">if</span> (AbstractHadoopGraphComputer.class.isAssignableFrom(graphComputerClass))
      <span class="keyword">return</span> graphComputerClass.getConstructor(HadoopGraph.class).newInstance(<span class="local-variable">this</span>);
    <span class="keyword">else</span>
      <span class="keyword">throw</span> Graph.Exceptions.graphDoesNotSupportProvidedGraphComputer(graphComputerClass);
  } <span class="keyword">catch</span> (<span class="directive">final</span> <span class="exception">Exception</span> e) {
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(e.getMessage(),e);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the configurations for Hadoop are assumed to be in the <code>Graph.configuration()</code> object. If this is not the
case, then the <code>Configuration</code> provided to <code>HadoopGraph.open()</code> should be dynamically created within the
<code>compute()</code>-method. It is in the provided configuration that <code>HadoopGraph</code> gets the various properties which
determine how to read and write data to and from Hadoop. For instance, <code>gremlin.hadoop.graphReader</code> and
<code>gremlin.hadoop.graphWriter</code>.</p>
</div>
<div class="sect4">
<h5 id="_graphfilteraware_interface">GraphFilterAware Interface</h5>
<div class="paragraph">
<p><a href="#graph-filter">Graph filters</a> by OLAP processors to only pull a subgraph of the full graph from the graph data source. For instance, the
example below constructs a <code>GraphFilter</code> that will only pull the "knows"-graph amongst people into the <code>GraphComputer</code>
for processing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">graph.compute().vertices(hasLabel(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)).edges(bothE(<span class="string"><span class="delimiter">&quot;</span><span class="content">knows</span><span class="delimiter">&quot;</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the provider has a custom <code>InputRDD</code>, they can implement <code>GraphFilterAware</code> and that graph filter will be provided to their
<code>InputRDD</code> at load time. For providers that use an <code>InputFormat</code>, state but the graph filter can be accessed from the configuration
as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (configuration.containsKey(Constants.GREMLIN_HADOOP_GRAPH_FILTER))
  <span class="local-variable">this</span>.graphFilter = VertexProgramHelper.deserialize(configuration, Constants.GREMLIN_HADOOP_GRAPH_FILTER);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_persistresultgraphaware_interface">PersistResultGraphAware Interface</h5>
<div class="paragraph">
<p>A graph system provider&#8217;s <code>OutputFormat</code> should implement the <code>PersistResultGraphAware</code> interface which
determines which persistence options are available to the user. For the standard file-based <code>OutputFormats</code> provided
by Hadoop-Gremlin (e.g. <a href="#gryo-io-format"><code>GryoOutputFormat</code></a>, <a href="#graphson-io-format"><code>GraphSONOutputFormat</code></a>,
and <a href="#script-io-format"><code>ScriptInputOutputFormat</code></a>) <code>ResultGraph.ORIGINAL</code> is not supported as the original graph
data files are not random access and are, in essence, immutable. Thus, these file-based <code>OutputFormats</code> only support
<code>ResultGraph.NEW</code> which creates a copy of the data specified by the <code>Persist</code> enum.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="io-implementations">IO Implementations</h4>
<div class="paragraph">
<p>If a <code>Graph</code> requires custom serializers for IO to work properly, implement the <code>Graph.io</code> method.  A typical example
of where a <code>Graph</code> would require such a custom serializers is if their identifier system uses non-primitive values,
such as OrientDB&#8217;s <code>Rid</code> class.  From basic serialization of a single <code>Vertex</code> all the way up the stack to Gremlin
Server, the need to know how to handle these complex identifiers is an important requirement.</p>
</div>
<div class="paragraph">
<p>The first step to implementing custom serializers is to first implement the <code>IoRegistry</code> interface and register the
custom classes and serializers to it. Each <code>Io</code> implementation has different requirements for what it expects from the
<code>IoRegistry</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>GraphML</strong> - No custom serializers expected/allowed.</p>
</li>
<li>
<p><strong>GraphSON</strong> - Register a Jackson <code>SimpleModule</code>.  The <code>SimpleModule</code> encapsulates specific classes to be serialized,
so it does not need to be registered to a specific class in the <code>IoRegistry</code> (use <code>null</code>).</p>
</li>
<li>
<p><strong>Gryo</strong> - Expects registration of one of three objects:</p>
<div class="ulist">
<ul>
<li>
<p>Register just the custom class with a <code>null</code> Kryo <code>Serializer</code> implementation - this class will use default "field-level" Kryo serialization.</p>
</li>
<li>
<p>Register the custom class with a specific Kryo `Serializer' implementation.</p>
</li>
<li>
<p>Register the custom class with a <code>Function&lt;Kryo, Serializer&gt;</code> for those cases where the Kryo <code>Serializer</code> requires the <code>Kryo</code> instance to get constructed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This implementation should provide a zero-arg constructor as the stack may require instantiation via reflection.
Consider extending <code>AbstractIoRegistry</code> for convenience as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyGraphIoRegistry</span> <span class="directive">extends</span> AbstractIoRegistry {
    <span class="directive">public</span> MyGraphIoRegistry() {
        register(GraphSONIo.class, <span class="predefined-constant">null</span>, <span class="keyword">new</span> MyGraphSimpleModule());
        register(GryoIo.class, MyGraphIdClass.class, <span class="keyword">new</span> MyGraphIdSerializer());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>Graph.io</code> method, provide the <code>IoRegistry</code> object to the supplied <code>Builder</code> and call the <code>create</code> method to
return that <code>Io</code> instance as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> &lt;I <span class="directive">extends</span> Io&gt; I io(<span class="directive">final</span> Io.Builder&lt;I&gt; builder) {
    <span class="keyword">return</span> (I) builder.graph(<span class="local-variable">this</span>).registry(myGraphIoRegistry).create();
}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this way, <code>Graph</code> implementations can pre-configure custom serializers for IO interactions and users will not need
to know about those details. Following this pattern will ensure proper execution of the test suite as well as
simplified usage for end-users.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Proper implementation of IO is critical to successful <code>Graph</code> operations in Gremlin Server.  The Test Suite
does have "serialization" tests that provide some assurance that an implementation is working properly, but those
tests cannot make assertions against any specifics of a custom serializer.  It is the responsibility of the
implementer to test the specifics of their custom serializers.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Consider separating serializer code into its own module, if possible, so that clients that use the <code>Graph</code>
implementation remotely don&#8217;t need a full dependency on the entire <code>Graph</code> - just the IO components and related
classes being serialized.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is an important implication to consider when the addition of a custom serializer. Presumably, the custom
serializer was written for the JVM to be deployed with a <code>Graph</code> instance. For example, a graph may expose a
geographical type like a <code>Point</code> or something similar. The library that contains <code>Point</code> assuming users expected to
deserialize back to a <code>Point</code> would need to have the library with <code>Point</code> and the &#8220;PointSerializer&#8221; class available
to them. In cases where that deployment approach is not desirable, it is possible to coerce a class like <code>Point</code> to
a type that is already in the list of types supported in TinkerPop. For example, <code>Point</code> could be coerced one-way to
<code>Map</code> of keys "x" and "y". Of course, on the client side, users would have to construct a <code>Map</code> for a <code>Point</code> which
isn&#8217;t quite as user-friendly.</p>
</div>
<div class="paragraph">
<p>If doing a type coercion is not desired, then it is important to remember that writing a <code>Point</code> class and related
serializer in Java is not sufficient for full support of Gremlin, as users of non-JVM Gremlin Language Variants (GLV)
will not be able to consume them. Getting full support would mean writing similar classes for each GLV. While
developing  those classes is not hard, it also means more code to support.</p>
</div>
<div class="sect4">
<h5 id="_supporting_gremlin_python_io">Supporting Gremlin-Python IO</h5>
<div class="paragraph">
<p>The serialization system of Gremlin-Python provides ways to add new types by creating serializers and deserializers in
Python and registering them with the <code>RemoteConnection</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">class</span> <span class="class">MyType</span>(<span class="predefined">object</span>):
  GRAPHSON_PREFIX = <span class="string"><span class="delimiter">&quot;</span><span class="content">providerx</span><span class="delimiter">&quot;</span></span>
  GRAPHSON_BASE_TYPE = <span class="string"><span class="delimiter">&quot;</span><span class="content">MyType</span><span class="delimiter">&quot;</span></span>
  GRAPHSON_TYPE = GraphSONUtil.formatType(GRAPHSON_PREFIX, GRAPHSON_BASE_TYPE)

  <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, x, y):
    <span class="predefined-constant">self</span>.x = x
    <span class="predefined-constant">self</span>.y = y

  <span class="decorator">@classmethod</span>
  <span class="keyword">def</span> <span class="function">objectify</span>(cls, value, reader):
    <span class="keyword">return</span> cls(value[<span class="string"><span class="delimiter">'</span><span class="content">x</span><span class="delimiter">'</span></span>], value[<span class="string"><span class="delimiter">'</span><span class="content">y</span><span class="delimiter">'</span></span>])

  <span class="decorator">@classmethod</span>
  <span class="keyword">def</span> <span class="function">dictify</span>(cls, value, writer):
    <span class="keyword">return</span> GraphSONUtil.typedValue(cls.GRAPHSON_BASE_TYPE,
                                  {<span class="string"><span class="delimiter">'</span><span class="content">x</span><span class="delimiter">'</span></span>: value.x, <span class="string"><span class="delimiter">'</span><span class="content">y</span><span class="delimiter">'</span></span>: value.y},
                                  cls.GRAPHSON_PREFIX)

graphson_reader = GraphSONReader({MyType.GRAPHSON_TYPE: MyType})
graphson_writer = GraphSONWriter({MyType: MyType})

connection = DriverRemoteConnection(<span class="string"><span class="delimiter">'</span><span class="content">ws://localhost:8182/gremlin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">g</span><span class="delimiter">'</span></span>,
                                     graphson_reader=graphson_reader,
                                     graphson_writer=graphson_writer)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_supporting_gremlin_net_io">Supporting Gremlin.Net IO</h5>
<div class="paragraph">
<p>The serialization system of Gremlin.Net provides ways to add new types by creating serializers and deserializers in
any .NET language and registering them with the <code>GremlinClient</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csharp">internal class MyType
{
    public static string GraphsonPrefix = &quot;providerx&quot;;
    public static string GraphsonBaseType = &quot;MyType&quot;;
    public static string GraphsonType = GraphSONUtil.FormatTypeName(GraphsonPrefix, GraphsonBaseType);

    public MyType(int x, int y)
    {
        X = x;
        Y = y;
    }

    public int X { get; }
    public int Y { get; }
}

internal class MyClassWriter : IGraphSONSerializer
{
    public Dictionary&lt;string, dynamic&gt; Dictify(dynamic objectData, GraphSONWriter writer)
    {
        MyType myType = objectData;
        var valueDict = new Dictionary&lt;string, object&gt;
        {
            {&quot;x&quot;, myType.X},
            {&quot;y&quot;, myType.Y}
        };
        return GraphSONUtil.ToTypedValue(nameof(TestClass), valueDict, MyType.GraphsonPrefix);
    }
}

internal class MyTypeReader : IGraphSONDeserializer
{
    public dynamic Objectify(JToken graphsonObject, GraphSONReader reader)
    {
        var x = reader.ToObject(graphsonObject[&quot;x&quot;]);
        var y = reader.ToObject(graphsonObject[&quot;y&quot;]);
        return new MyType(x, y);
    }
}

var graphsonReader = new GraphSONReader(
    new Dictionary&lt;string, IGraphSONDeserializer&gt; {{MyType.GraphsonType, new MyTypeReader()}});
var graphsonWriter = new GraphSONWriter(
    new Dictionary&lt;Type, IGraphSONSerializer&gt; {{typeof(MyType), new MyClassWriter()}});

var gremlinClient = new GremlinClient(new GremlinServer(&quot;localhost&quot;, 8182), graphsonReader, graphsonWriter);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="remoteconnection-implementations">RemoteConnection Implementations</h4>
<div class="paragraph">
<p>A <code>RemoteConnection</code> is an interface that is important for usage on traversal sources configured using the
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#connecting-via-remotegraph">withRemote()</a> option. A <code>Traversal</code>
that is generated from that source will apply a <code>RemoteStrategy</code> which will inject a <code>RemoteStep</code> to its end. That
step will then send the <code>Bytecode</code> of the <code>Traversal</code> over the <code>RemoteConnection</code> to get the results that it will
iterate.</p>
</div>
<div class="paragraph">
<p>There is one method to implement on <code>RemoteConnection</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> &lt;E&gt; CompletableFuture&lt;RemoteTraversal&lt;?, E&gt;&gt; submitAsync(<span class="directive">final</span> Bytecode bytecode) <span class="directive">throws</span> RemoteConnectionException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it returns a <code>RemoteTraversal</code>. This interface should also be implemented and in most cases implementers can
simply extend the <code>AbstractRemoteTraversal</code>, which provides default implementations for all the <code>Traversal</code> methods
except for the important one <code>getSideEffects()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> RemoteTraversalSideEffects getSideEffects();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method has been overridden from <code>Traversal</code> to return <code>RemoteTraversalSideEffects</code> and this interface allows a user
to do a retrieval of any side-effects produced by the <code>Traversal</code>. The assumption, of course, is that the
<code>RemoteConnection</code> is communicating with a server that supports side-effect retrieval (as Gremlin Server does).</p>
</div>
<div class="paragraph">
<p>TinkerPop provides the <code>DriverRemoteConnection</code> as a useful and
<a href="https://github.com/apache/tinkerpop/blob/3.3.1/gremlin-driver/src/main/java/org/apache/tinkerpop/gremlin/driver/remote">example implementation</a>.
<code>DriverRemoteConnection</code> serializes the <code>Traversal</code> and then submits it for remote processing on Gremlin Server.
Gremlin Server rebinds the <code>Traversal</code> to a configured <code>Graph</code> instance and then iterates the results back as it would
normally do.</p>
</div>
<div class="paragraph">
<p>Implementing <code>RemoteConnection</code> is not something routinely done for those implementing <code>gremlin-core</code>. It is only
something required if there is a need to exploit <code>withRemote()</code> in some way. If a graph provider has a "graph server"
similar to Gremlin Server that can accept a serialized <code>Traversal</code> instance, then that would be one example of a
reason to implement this interface.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validating-with-gremlin-test">Validating with Gremlin-Test</h3>
<div class="paragraph">
<p><span class="image"><img src="../../images/gremlin-edumacated.png" alt="gremlin edumacated" width="225"></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.apache.tinkerpop<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>gremlin-test<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>3.3.1<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The operational semantics of any OLTP or OLAP implementation are validated by <code>gremlin-test</code>. To implement these tests,
provide test case implementations as shown below, where <code>XXX</code> below denotes the name of the graph implementation (e.g.
TinkerGraph, Neo4jGraph, HadoopGraph, etc.).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Structure API tests</span>
<span class="annotation">@RunWith</span>(StructureStandardSuite.class)
<span class="annotation">@GraphProviderClass</span>(provider = XXXGraphProvider.class, graph = XXXGraph.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">XXXStructureStandardTest</span> {}

<span class="comment">// Process API tests</span>
<span class="annotation">@RunWith</span>(ProcessComputerSuite.class)
<span class="annotation">@GraphProviderClass</span>(provider = XXXGraphProvider.class, graph = XXXGraph.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">XXXProcessComputerTest</span> {}

<span class="annotation">@RunWith</span>(ProcessStandardSuite.class)
<span class="annotation">@GraphProviderClass</span>(provider = XXXGraphProvider.class, graph = XXXGraph.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">XXXProcessStandardTest</span> {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above set of tests represent the minimum test suite set to implement.  There are other "integration" and
"performance" tests that should be considered optional.  Implementing those tests requires the same pattern as shown
above.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
It is as important to look at "ignored" tests as it is to look at ones that fail.  The <code>gremlin-test</code>
suite utilizes the <code>Feature</code> implementation exposed by the <code>Graph</code> to determine which tests to execute.  If a test
utilizes features that are not supported by the graph, it will ignore them.  While that may be fine, implementers
should validate that the ignored tests are appropriately bypassed and that there are no mistakes in their feature
definitions.  Moreover, implementers should consider filling gaps in their own test suites, especially when
IO-related tests are being ignored.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The only test-class that requires any code investment is the <code>GraphProvider</code> implementation class. This class is a
used by the test suite to construct <code>Graph</code> configurations and instances and provides information about the
implementation itself.  In most cases, it is best to simply extend <code>AbstractGraphProvider</code> as it provides many
default implementations of the <code>GraphProvider</code> interface.</p>
</div>
<div class="paragraph">
<p>Finally, specify the test suites that will be supported by the <code>Graph</code> implementation using the <code>@Graph.OptIn</code>
annotation.  See the <code>TinkerGraph</code> implementation below as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Graph</span>.OptIn(Graph.OptIn.SUITE_STRUCTURE_STANDARD)
<span class="annotation">@Graph</span>.OptIn(Graph.OptIn.SUITE_PROCESS_STANDARD)
<span class="annotation">@Graph</span>.OptIn(Graph.OptIn.SUITE_PROCESS_COMPUTER)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TinkerGraph</span> <span class="directive">implements</span> Graph {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only include annotations for the suites the implementation will support.  Note that implementing the suite, but
not specifying the appropriate annotation will prevent the suite from running (an obvious error message will appear
in this case when running the mis-configured suite).</p>
</div>
<div class="paragraph">
<p>There are times when there may be a specific test in the suite that the implementation cannot support (despite the
features it implements) or should not otherwise be executed.  It is possible for implementers to "opt-out" of a test
by using the <code>@Graph.OptOut</code> annotation.  The following is an example of this annotation usage as taken from
<code>HadoopGraph</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Graph</span>.OptIn(Graph.OptIn.SUITE_PROCESS_STANDARD)
<span class="annotation">@Graph</span>.OptIn(Graph.OptIn.SUITE_PROCESS_COMPUTER)
<span class="annotation">@Graph</span>.OptOut(
        test = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.tinkerpop.gremlin.process.graph.step.map.MatchTest$Traversals</span><span class="delimiter">&quot;</span></span>,
        method = <span class="string"><span class="delimiter">&quot;</span><span class="content">g_V_matchXa_hasXname_GarciaX__a_inXwrittenByX_b__a_inXsungByX_bX</span><span class="delimiter">&quot;</span></span>,
        reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hadoop-Gremlin is OLAP-oriented and for OLTP operations, linear-scan joins are required. This particular tests takes many minutes to execute.</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Graph</span>.OptOut(
        test = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.tinkerpop.gremlin.process.graph.step.map.MatchTest$Traversals</span><span class="delimiter">&quot;</span></span>,
        method = <span class="string"><span class="delimiter">&quot;</span><span class="content">g_V_matchXa_inXsungByX_b__a_inXsungByX_c__b_outXwrittenByX_d__c_outXwrittenByX_e__d_hasXname_George_HarisonX__e_hasXname_Bob_MarleyXX</span><span class="delimiter">&quot;</span></span>,
        reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hadoop-Gremlin is OLAP-oriented and for OLTP operations, linear-scan joins are required. This particular tests takes many minutes to execute.</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Graph</span>.OptOut(
        test = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.tinkerpop.gremlin.process.computer.GraphComputerTest</span><span class="delimiter">&quot;</span></span>,
        method = <span class="string"><span class="delimiter">&quot;</span><span class="content">shouldNotAllowBadMemoryKeys</span><span class="delimiter">&quot;</span></span>,
        reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hadoop does a hard kill on failure and stops threads which stops test cases. Exception handling semantics are correct though.</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Graph</span>.OptOut(
        test = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.tinkerpop.gremlin.process.computer.GraphComputerTest</span><span class="delimiter">&quot;</span></span>,
        method = <span class="string"><span class="delimiter">&quot;</span><span class="content">shouldRequireRegisteringMemoryKeys</span><span class="delimiter">&quot;</span></span>,
        reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hadoop does a hard kill on failure and stops threads which stops test cases. Exception handling semantics are correct though.</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HadoopGraph</span> <span class="directive">implements</span> Graph {</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above examples show how to ignore individual tests.  It is also possible to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ignore an entire test case (i.e. all the methods within the test) by setting the <code>method</code> to "*".</p>
</li>
<li>
<p>Ignore a "base" test class such that test that extend from those classes will all be ignored.</p>
</li>
<li>
<p>Ignore a <code>GraphComputer</code> test based on the type of <code>GraphComputer</code> being used.  Specify the "computer" attribute on
the <code>OptOut</code> (which is an array specification) which should have a value of the <code>GraphComputer</code> implementation class
that should ignore that test. This attribute should be left empty for "standard" execution and by default all
<code>GraphComputer</code> implementations will be included in the <code>OptOut</code> so if there are multiple implementations, explicitly
specify the ones that should be excluded.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also note that some of the tests in the Gremlin Test Suite are parameterized tests and require an additional level of
specificity to be properly ignored.  To ignore these types of tests, examine the name template of the parameterized
tests.  It is defined by a Java annotation that looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Parameterized</span>.Parameters(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">expect({0})</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The annotation above shows that the name of each parameterized test will be prefixed with "expect" and have
parentheses wrapped around the first parameter (at index 0) value supplied to each test.  This information can
only be garnered by studying the test set up itself.  Once the pattern is determined and the specific unique name of
the parameterized test is identified, add it to the <code>specific</code> property on the <code>OptOut</code> annotation in addition to
the other arguments.</p>
</div>
<div class="paragraph">
<p>These annotations help provide users a level of transparency into test suite compliance (via the
<a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#describe-graph">describeGraph()</a> utility function). It also
allows implementers to have a lot of flexibility in terms of how they wish to support TinkerPop.  For example, maybe
there is a single test case that prevents an implementer from claiming support of a <code>Feature</code>.  The implementer could
choose to either not support the <code>Feature</code> or to support it but "opt-out" of the test with a "reason" as to why so
that users understand the limitation.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Before using <code>OptOut</code> be sure that the reason for using it is sound and it is more of a last resort.
It is possible that a test from the suite doesn&#8217;t properly represent the expectations of a feature, is too broad or
narrow for the semantics it is trying to enforce or simply contains a bug.  Please consider raising issues in the
developer mailing list with such concerns before assuming <code>OptOut</code> is the only answer.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
There are no tests that specifically validate complete compliance with Gremlin Server.  Generally speaking,
a <code>Graph</code> that passes the full Test Suite, should be compliant with Gremlin Server.  The one area where problems can
occur is in serialization.  Always ensure that IO is properly implemented, that custom serializers are tested fully
and ultimately integration test the <code>Graph</code> with an actual Gremlin Server instance.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Configuring tests to run in parallel might result in errors that are difficult to debug as there is some
shared state in test execution around graph configuration.  It is therefore recommended that parallelism be turned
off for the test suite (the Maven SureFire Plugin is configured this way by default).  It may also be important to
include this setting, <code>&lt;reuseForks&gt;false&lt;/reuseForks&gt;</code>, in the SureFire configuration if tests are failing in an
unexplainable way.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When running the <code>gremlin-test</code> suite against your implementation, you may need to set <code>build.dir</code> as an
environment variable, depending on your project layout. Some tests require this to find a writable directory for
creating temporary files. The value is typically set to the project build directory. For example using the Maven
SureFire Plugin, this is done via the configuration argLine with <code>-Dbuild.dir=${project.build.directory}</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_accessibility_via_gremlinplugin">Accessibility via GremlinPlugin</h3>
<div class="paragraph">
<p><span class="image" style="float: left"><img src="../../images/gremlin-plugin.png" alt="gremlin plugin" width="100"></span> The applications distributed with TinkerPop3 do not distribute with
any graph system implementations besides TinkerGraph. If your implementation is stored in a Maven repository (e.g.
Maven Central Repository), then it is best to provide a <a href="#gremlin-plugins"><code>GremlinPlugin</code></a> implementation so the respective jars can be
downloaded according and when required by the user. Neo4j&#8217;s GremlinPlugin is provided below for reference.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">
<span class="keyword">package</span> <span class="namespace">org.apache.tinkerpop.gremlin.neo4j.jsr223</span>;

<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.AbstractGremlinPlugin</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.DefaultImportCustomizer</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.ImportCustomizer</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.process.traversal.LabelP</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jEdge</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jElement</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jGraph</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jGraphVariables</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jHelper</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jProperty</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jVertex</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.neo4j.structure.Neo4jVertexProperty</span>;

<span class="comment">/**
 * @author Stephen Mallette (http://stephen.genoprime.com)
 */</span>
<span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">Neo4jGremlinPlugin</span> <span class="directive">extends</span> AbstractGremlinPlugin {

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> NAME = <span class="string"><span class="delimiter">&quot;</span><span class="content">tinkerpop.neo4j</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> ImportCustomizer imports;

    <span class="directive">static</span> {
        <span class="keyword">try</span> {
            imports = DefaultImportCustomizer.build()
                    .addClassImports(Neo4jEdge.class,
                            Neo4jElement.class,
                            Neo4jGraph.class,
                            Neo4jGraphVariables.class,
                            Neo4jHelper.class,
                            Neo4jProperty.class,
                            Neo4jVertex.class,
                            Neo4jVertexProperty.class,
                            LabelP.class)
                    .addMethodImports(LabelP.class.getMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">of</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class)).create();
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(ex);
        }
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> Neo4jGremlinPlugin instance = <span class="keyword">new</span> Neo4jGremlinPlugin();

    <span class="directive">public</span> Neo4jGremlinPlugin() {
        <span class="local-variable">super</span>(NAME, imports);
    }

    <span class="directive">public</span> <span class="directive">static</span> Neo4jGremlinPlugin instance() {
        <span class="keyword">return</span> instance;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> requireRestart() {
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above plugin implementations, users can now download respective binaries for Gremlin Console, Gremlin Server, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">gremlin&gt; g = Neo4jGraph.open(<span class="string"><span class="delimiter">'</span><span class="content">/tmp/neo4j</span><span class="delimiter">'</span></span>)
No such <span class="key">property</span>: Neo4jGraph <span class="keyword">for</span> <span class="type">class</span>: <span class="class">groovysh_evaluate</span>
Display stack trace? [yN]
gremlin&gt; :install org.apache.tinkerpop neo4j-gremlin 3.3.1
==&gt;<span class="key">loaded</span>: [org.apache.tinkerpop, neo4j-gremlin, <span class="error">…</span>]
gremlin&gt; :plugin use tinkerpop.neo4j
==&gt;tinkerpop.neo4j activated
gremlin&gt; g = Neo4jGraph.open(<span class="string"><span class="delimiter">'</span><span class="content">/tmp/neo4j</span><span class="delimiter">'</span></span>)
==&gt;neo4jgraph[EmbeddedGraphDatabase [<span class="regexp"><span class="delimiter">/</span><span class="content">tmp</span><span class="delimiter">/</span></span>neo4j]]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_in_depth_implementations">In-Depth Implementations</h3>
<div class="paragraph">
<p><span class="image" style="float: right"><img src="../../images/gremlin-painting.png" alt="gremlin painting" width="200"></span> The graph system implementation details presented thus far are
minimum requirements necessary to yield a valid TinkerPop3 implementation. However, there are other areas that a
graph system provider can tweak to provide an implementation more optimized for their underlying graph engine. Typical
areas of focus include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Traversal Strategies: A <a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#traversalstrategy">TraversalStrategy</a>
can be used to alter a traversal prior to its execution. A typical example is converting a pattern of
<code>g.V().has('name','marko')</code> into a global index lookup for all vertices with name "marko". In this way, a <code>O(|V|)</code>
lookup becomes an <code>O(log(|V|))</code>. Please review <code>TinkerGraphStepStrategy</code> for ideas.</p>
</li>
<li>
<p>Step Implementations: Every <a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#graph-traversal-steps">step</a> is
ultimately referenced by the <code>GraphTraversal</code> interface. It is possible to extend <code>GraphTraversal</code> to use a graph
system specific step implementation.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_graph_driver_provider_requirements">Graph Driver Provider Requirements</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="../../images/gremlin-server-protocol.png" alt="gremlin server protocol" width="325">
</div>
</div>
<div class="paragraph">
<p>One of the roles for <a href="http://tinkerpop.apache.org/docs/3.3.1/reference/#gremlin-server">Gremlin Server</a> is to
provide a bridge from TinkerPop to non-JVM languages (e.g. Go, Python, etc.).  Developers can build language bindings
(or driver) that provide a way to submit Gremlin scripts to Gremlin Server and get back results.  Given the
extensible nature of Gremlin Server, it is difficult to provide an authoritative guide to developing a driver.
It is however possible to describe the core communication protocol using the standard out-of-the-box configuration
which should provide enough information to develop a driver for a specific language.</p>
</div>
<div class="imageblock" style="float: right">
<div class="content">
<img src="../../images/gremlin-server-flow.png" alt="gremlin server flow" width="300">
</div>
</div>
<div class="paragraph">
<p>Gremlin Server is distributed with a configuration that utilizes <a href="http://en.wikipedia.org/wiki/WebSocket">WebSocket</a>
with a custom sub-protocol.  Under this configuration, Gremlin Server accepts requests containing a Gremlin script,
evaluates that script and then streams back the results.  The notion of "streaming" is depicted in the diagram to the
right.</p>
</div>
<div class="paragraph">
<p>The diagram shows an incoming request to process the Gremlin script of <code>g.V()</code>.  Gremlin Server evaluates that script,
getting an <code>Iterator</code> of vertices as a result, and steps through each <code>Vertex</code> within it.  The vertices are batched
together given the <code>resultIterationBatchSize</code> configuration.  In this case, that value must be <code>2</code> given that each
"response" contains two vertices.  Each response is serialized given the requested serializer type (JSON is likely
best for non-JVM languages) and written back to the requesting client immediately.  Gremlin Server does not wait for
the entire result to be iterated, before sending back a response.  It will send the responses as they are realized.</p>
</div>
<div class="paragraph">
<p>This approach allows for the processing of large result sets without having to serialize the entire result into memory
for the response.  It places a bit of a burden on the developer of the driver however, because it becomes necessary to
provide a way to reconstruct the entire result on the client side from all of the individual responses that Gremlin
Server returns for a single request.  Again, this description of Gremlin Server&#8217;s "flow" is related to the
out-of-the-box configuration.  It is quite possible to construct other flows, that might be more amenable to a
particular language or style of processing.</p>
</div>
<div class="paragraph">
<p>To formulate a request to Gremlin Server, a <code>RequestMessage</code> needs to be constructed.  The <code>RequestMessage</code> is a
generalized representation of a request that carries a set of "standard" values in addition to optional ones that are
dependent on the operation being performed.  A <code>RequestMessage</code> has these fields:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">requestId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="http://en.wikipedia.org/wiki/Globally_unique_identifier">UUID</a> representing the unique identification for the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the "operation" to execute based on the available <code>OpProcessor</code> configured in the Gremlin Server.  To evaluate a script, use <code>eval</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the <code>OpProcessor</code> to utilize. The default <code>OpProcessor</code> for evaluating scripts is unnamed and therefore script evaluation purposes, this value can be an empty string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">args</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>Map</code> of arbitrary parameters to pass to Gremlin Server.  The requirements for the contents of this <code>Map</code> are dependent on the <code>op</code> selected.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This message can be serialized in any fashion that is supported by Gremlin Server.  New serialization methods can
be plugged in by implementing a <code>ServiceLoader</code> enabled <code>MessageSerializer</code>, however Gremlin Server provides for
JSON serialization by default which will be good enough for purposes of most developers building drivers.
A <code>RequestMessage</code> to evaluate a script with variable bindings looks like this in JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js">{ <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1d6d02bd-8e56-421d-9438-3bd6d0079ff1</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">op</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">eval</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">processor</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">args</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">gremlin</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">g.traversal().V(x).out()</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">bindings</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>},
          <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">gremlin-groovy</span><span class="delimiter">&quot;</span></span>}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above JSON represents the "body" of the request to send to Gremlin Server. When sending this "body" over
WebSocket, Gremlin Server can accept a packet frame using a "text" (1) or a "binary" (2) opcode. Using "text"
is a bit more limited in that Gremlin Server will always process the body of that request as JSON.  Generally speaking
"text" is just for testing purposes.</p>
</div>
<div class="paragraph">
<p>The preferred method for sending requests to Gremlin Server is to use the "binary" opcode.  In this case, a "header"
will need be sent in addition to to the "body".  The "header" basically consists of a "mime type" so that Gremlin
Server knows how to deserialize the <code>RequestMessage</code>. So, the actual byte array sent to Gremlin Server would be
formatted as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../images/gremlin-server-request.png" alt="gremlin server request">
</div>
</div>
<div class="paragraph">
<p>The first byte represents the length of the "mime type" string value that follows.  Given the default configuration of
Gremlin Server, this value should be set to <code>application/json</code>.  The "payload" represents the JSON message above
encoded as bytes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gremlin Server will only accept masked packets as it pertains to a WebSocket packet header construction.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When Gremlin Server receives that request, it will decode it given the "mime type", pass it to the requested
<code>OpProcessor</code> which will execute the <code>op</code> defined in the message.  In this case, it will evaluate the script
<code>g.traversal().V(x).out()</code> using the <code>bindings</code> supplied in the <code>args</code> and stream back the results in a series of
<code>ResponseMessages</code>.  A <code>ResponseMessage</code> looks like this:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">requestId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The identifier of the <code>RequestMessage</code> that generated this <code>ResponseMessage</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>status</code> contains a <code>Map</code> of three keys: <code>code</code> which refers to a <code>ResultCode</code> that is somewhat analogous to an <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">HTTP status code</a>, <code>attributes</code> that represent a <code>Map</code> of protocol-level information, and <code>message</code> which is just a human-readable <code>String</code> usually associated with errors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>result</code> contains a <code>Map</code> of two keys: <code>data</code> which refers to the actual data returned from the server (the type of data is determined by the operation requested) and <code>meta</code> which is a <code>Map</code> of meta-data related to the response.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In this case the <code>ResponseMessage</code> returned to the client would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js">{<span class="key"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">data</span><span class="delimiter">&quot;</span></span>:[{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="integer">2</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">vertex</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span>: [
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="integer">2</span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">vadas</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="integer">3</span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="integer">27</span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>}]},
  ], <span class="key"><span class="delimiter">&quot;</span><span class="content">meta</span><span class="delimiter">&quot;</span></span>:{}},
 <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1d6d02bd-8e56-421d-9438-3bd6d0079ff1</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">code</span><span class="delimiter">&quot;</span></span>:<span class="integer">206</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">attributes</span><span class="delimiter">&quot;</span></span>:{},<span class="key"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gremlin Server is capable of streaming results such that additional responses will arrive over the WebSocket connection until
the iteration of the result on the server is complete.  Each successful incremental message will have a <code>ResultCode</code>
of <code>206</code>. Termination of the stream will be marked by a final <code>200</code> status code.  Note that all messages without a
<code>206</code> represent terminating conditions for a request.  The following table details the various status codes that
Gremlin Server will send:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUCCESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server successfully processed a request to completion - there are no messages remaining in this stream.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NO CONTENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server processed the request but there is no result to return (e.g. an <code>Iterator</code> with no elements) - there are no messages remaining in this stream.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">206</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PARTIAL CONTENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server successfully returned some content, but there is more in the stream to arrive - wait for a <code>SUCCESS</code> to signify the end of the stream.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNAUTHORIZED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The request attempted to access resources that the requesting user did not have access to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">407</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTHENTICATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A challenge from the server for the client to authenticate its request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">498</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MALFORMED REQUEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The request message was not properly formatted which means it could not be parsed at all or the "op" code was not recognized such that Gremlin Server could properly route it for processing.  Check the message format and retry the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INVALID REQUEST ARGUMENTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The request message was parseable, but the arguments supplied in the message were in conflict or incomplete. Check the message format and retry the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVER ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A general server error occurred that prevented the request from being processed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">597</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPT EVALUATION ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The script submitted for processing evaluated in the <code>ScriptEngine</code> with errors and could not be processed.  Check the script submitted for syntax errors or other problems and then resubmit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">598</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVER TIMEOUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server exceeded one of the timeout settings for the request and could therefore only partially responded or did not respond at all.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">599</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVER SERIALIZATION ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server was not capable of serializing an object that was returned from the script supplied on the request. Either transform the object into something Gremlin Server can process within the script or install mapper serialization classes to Gremlin Server.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the <a href="http://tinkerpop.apache.org/docs/current/dev/io">IO Reference Documentation</a> for more
examples of <code>RequestMessage</code> and <code>ResponseMessage</code> instances.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_opprocessors_arguments">OpProcessors Arguments</h3>
<div class="paragraph">
<p>The following sections define a non-exhaustive list of available operations and arguments for embedded <code>OpProcessors</code>
(i.e. ones packaged with Gremlin Server).</p>
</div>
<div class="sect3">
<h4 id="_common">Common</h4>
<div class="paragraph">
<p>All <code>OpProcessor</code> instances support these arguments.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">batchSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the result is an iterator this value defines the number of iterations each <code>ResponseMessage</code> should contain - overrides the <code>resultIterationBatchSize</code> server setting.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_standard_opprocessor">Standard OpProcessor</h4>
<div class="paragraph">
<p>The "standard" <code>OpProcessor</code> handles requests for the primary function of Gremlin Server - executing Gremlin.
Requests made to this <code>OpProcessor</code> are "sessionless" in the sense that a request must encapsulate the entirety
of a transaction.  There is no state maintained between requests.  A transaction is started when the script is first
evaluated and is committed when the script completes (or rolled back if an error occurred).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>As this is the default <code>OpProcessor</code> this value can be set to an empty string.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">op</p></td>
<td class="tableblock halign-left valign-top"><div><table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A request that contains the response to a server challenge for authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluate a Gremlin script provided as a <code>String</code>.</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`authentication` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sasl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The response to the server authentication challenge.  This value is dependent on the SASL authentication mechanism required by the server and is Base64 encoded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">saslMechanism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SASL mechanism: <code>PLAIN</code> or <code>GSSAPI</code>. Note that it is up to the server implementation to use or disregard this setting (default implementation in Gremlin Server ignores it).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`eval` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gremlin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The Gremlin script to evaluate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A map of key/value pairs to apply as variables in the context of the Gremlin script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flavor of Gremlin used (e.g. <code>gremlin-groovy</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A map of key/value pairs that allow globally bound <code>Graph</code> and <code>TraversalSource</code> objects to
be aliased to different variable names for purposes of the current request.  The value represents the name of the
global variable and its key represents the new binding name as it will be referenced in the Gremlin query.  For
example, if the Gremlin Server defines two <code>TraversalSource</code> instances named <code>g1</code> and <code>g2</code>, it would be possible
to send an alias pair with key of "g" and value of "g2" and thus allow the script to refer to "g2" simply as "g".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scriptEvaluationTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An override for the server setting that determines the maximum time to wait for a script to execute on the server.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_session_opprocessor">Session OpProcessor</h4>
<div class="paragraph">
<p>The "session" <code>OpProcessor</code> handles requests for the primary function of Gremlin Server - executing Gremlin. It is
like the "standard" <code>OpProcessor</code>, but instead maintains state between sessions and allows the option to leave all
transaction management up to the calling client.  It is important that clients that open sessions, commit or roll
them back, however Gremlin Server will try to clean up such things when a session is killed that has been abandoned.
It is important to consider that a session can only be maintained with a single machine.  In the event that multiple
Gremlin Server are deployed, session state is not shared among them.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This value should be set to <code>session</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">op</p></td>
<td class="tableblock halign-left valign-top"><div><table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A request that contains the response to a server challenge for authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluate a Gremlin script provided as a <code>String</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>close</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Close the specified session. Will return a <code>NO CONTENT</code> message as confirmation of the close being completed.</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`authentication` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">saslMechanism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SASL mechanism: <code>PLAIN</code> or <code>GSSAPI</code>. Note that it is up to the server implementation to use or disregard this setting (default implementation in Gremlin Server ignores it).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sasl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The response to the server authentication challenge.  This value is dependent on the SASL authentication mechanism required by the server and is Base64 encoded.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`eval` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gremlin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The Gremlin script to evaluate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The session identifier for the current session - typically this value should be a UUID (the session will be created if it doesn&#8217;t exist).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageTransaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to <code>true</code> the transaction for the current request is auto-committed or rolled-back as are done with sessionless requests - defaulted to <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A map of key/value pairs to apply as variables in the context of the Gremlin script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scriptEvaluationTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An override for the server setting that determines the maximum time to wait for a script to execute on the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flavor of Gremlin used (e.g. <code>gremlin-groovy</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A map of key/value pairs that allow globally bound <code>Graph</code> and <code>TraversalSource</code> objects to
be aliased to different variable names for purposes of the current request.  The value represents the name the
global variable and its key represents the new binding name as it will be referenced in the Gremlin query.  For
example, if the Gremlin Server defines two <code>TraversalSource</code> instances named <code>g1</code> and <code>g2</code>, it would be possible
to send an alias pair with key of "g" and value of "g2" and thus allow the script to refer to "g2" simply as "g".</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`close` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The session identifier for the session to close.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">force</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines if the session should be force closed when the client is closed. Force closing will not
attempt to close open transactions from existing running jobs and leave it to the underlying graph to decided how to
proceed with those orphaned transactions. Setting this to <code>true</code> tends to lead to faster close operation and release
of resources which can be desirable if Gremlin Server has a long session timeout and a long script evaluation timeout
as attempts to close long run jobs can occur more rapidly. If not provided, this value is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_traversal_opprocessor">Traversal OpProcessor</h4>
<div class="paragraph">
<p>Both the Standard and Session OpProcessors allow for Gremlin scripts to be submitted to the server. The
<code>TraversalOpProcessor</code> however allows Gremlin <code>Bytecode</code> to be submitted to the server. Supporting this <code>OpProcessor</code>
makes it possible for a <a href="http://tinkerpop.apache.org/docs/current/tutorials/gremlin-language-variants/">Gremlin Language Variant</a>
to submit a <code>Traversal</code> directly to Gremlin Server in the native language of the GLV without having to use a script in
a different language.</p>
</div>
<div class="paragraph">
<p>Unlike Standard and Session OpProcessors, the Traversal OpProcessor does not simply return the results of the
<code>Traversal</code>. It instead returns <code>Traverser</code> objects which allows the client to take advantage of
<a href="http://tinkerpop.apache.org/docs/current/reference/#barrier-step">bulking</a>. To describe this interaction more
directly, the returned <code>Traverser</code> will represent some value from the <code>Traversal</code> result and the number of times it
is represented in the full stream of results. So, if a <code>Traversal</code> happens to return the same vertex twenty times
it won&#8217;t return twenty instances of the same object. It will return one in <code>Traverser</code> with the <code>bulk</code> value set to
twenty. Under this model, the amount of processing and network overhead can be reduced considerably.</p>
</div>
<div class="paragraph">
<p>To demonstrate consider this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">gremlin&gt; cluster = Cluster.open()
==&gt;localhost/<span class="float">127.0</span><span class="float">.0</span><span class="float">.1</span>:<span class="integer">8182</span>
gremlin&gt; client = cluster.connect()
==&gt;org.apache.tinkerpop.gremlin.driver.Client<span class="error">$</span>ClusteredClient<span class="error">@</span><span class="integer">7497</span>a554
gremlin&gt; aliased = client.alias(<span class="string"><span class="delimiter">&quot;</span><span class="content">g</span><span class="delimiter">&quot;</span></span>)
==&gt;org.apache.tinkerpop.gremlin.driver.Client<span class="error">$</span>AliasClusteredClient<span class="error">@</span><span class="float">77f</span><span class="integer">4038</span>c
gremlin&gt; g = org.apache.tinkerpop.gremlin.structure.util.empty.EmptyGraph.INSTANCE.traversal() <span class="invisible">//</span><b class="conum">1</b><span class="invisible">\</span>
==&gt;graphtraversalsource[emptygraph[empty], standard]
gremlin&gt; rs = aliased.submit(g.V().both().barrier().both().barrier()).all().get() <span class="invisible">//</span><b class="conum">2</b><span class="invisible">\</span>
==&gt;result{object=v[<span class="integer">1</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
==&gt;result{object=v[<span class="integer">4</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
==&gt;result{object=v[<span class="integer">6</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
==&gt;result{object=v[<span class="integer">5</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
==&gt;result{object=v[<span class="integer">3</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
==&gt;result{object=v[<span class="integer">2</span>] <span class="type">class</span>=<span class="class">org</span>.apache.tinkerpop.gremlin.process.remote.traversal.DefaultRemoteTraverser}
gremlin&gt; aliased.submit(g.V().both().barrier().both().barrier().count()).all().get().get(<span class="integer">0</span>).getInt() <span class="invisible">//</span><b class="conum">3</b><span class="invisible">\</span>
==&gt;<span class="integer">30</span>
gremlin&gt; rs.collect{[<span class="key">value</span>: <span class="local-variable">it</span>.getObject().get(), <span class="key">bulk</span>: <span class="local-variable">it</span>.getObject().bulk()]} <span class="invisible">//</span><b class="conum">4</b><span class="invisible">\</span>
==&gt;[<span class="key">value</span>:v[<span class="integer">1</span>],<span class="key">bulk</span>:<span class="integer">7</span>]
==&gt;[<span class="key">value</span>:v[<span class="integer">4</span>],<span class="key">bulk</span>:<span class="integer">7</span>]
==&gt;[<span class="key">value</span>:v[<span class="integer">6</span>],<span class="key">bulk</span>:<span class="integer">3</span>]
==&gt;[<span class="key">value</span>:v[<span class="integer">5</span>],<span class="key">bulk</span>:<span class="integer">3</span>]
==&gt;[<span class="key">value</span>:v[<span class="integer">3</span>],<span class="key">bulk</span>:<span class="integer">7</span>]
==&gt;[<span class="key">value</span>:v[<span class="integer">2</span>],<span class="key">bulk</span>:<span class="integer">3</span>]</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>All commands through this step are just designed to demonstrate bulking with Gremlin Server and don&#8217;t represent
a real-world way that this feature would be used.</p>
</li>
<li>
<p>Submit a <code>Traversal</code> that happens to ensure that the server uses bulking. Note that a <code>Traverser</code> is returned
and that there are only six results.</p>
</li>
<li>
<p>In actuality, however, if this same <code>Traversal</code> is iterated there are thirty results. Without bulking, the previous
request would have sent back thirty traversers.</p>
</li>
<li>
<p>Note that the sum of the bulk of each <code>Traverser</code> is thirty.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The full iteration of a <code>Traversal</code> is thus left to the client. It must interpret the bulk on the <code>Traverser</code> and
unroll it to represent the actual number of times it exists when iterated. The unrolling is typically handled
directly within TinkerPop&#8217;s <code>RemoteGraph</code> implementations.</p>
</div>
<div class="paragraph">
<p>One of the important aspects of the Traversal OpProcessor is that it enables the user to not only get the results of
the <code>Traversal</code> but also the side-effects that it produces. When the <code>Traversal</code> is submitted with the "bytecode"
operation, the results are iterated back as usual, but any side-effects are retained on the server in a cache keyed by
the identifier of the request that originally submitted the <code>Traversal</code>. The client will want to retain that identifier
if it intends to later get side-effects. The Traversal OpProcessor supplies the "keys" and "gather" operations to get
the keys stored in the side-effect and to get the value of a specific side-effect respectively. Finally, a "close"
operation is available to clear the cache of a specific side-effect.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This value should be set to <code>traversal</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">op</p></td>
<td class="tableblock halign-left valign-top"><div><table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A request that contains the response to a server challenge for authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bytecode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A request that contains the <code>Bytecode</code> representation of a <code>Traversal</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>close</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Releases side-effects held in cache for a particular <code>Traversal</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gather</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets a particular side-effect as produced by a previously executed <code>Traversal</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets all the keys of all side-effects as produced by a previously executed <code>Traversal</code>.</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`authentication` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sasl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The response to the server authentication challenge.  This value is dependent on the SASL authentication mechanism required by the server and is Base64 encoded.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`bytecode` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gremlin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The <code>Bytecode</code> representation of a <code>Traversal</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> A map with a single key/value pair that refers to a globally bound <code>TraversalSource</code> object
to be aliased to different variable names for purposes of the current request.  The value represents the name of the
global variable and its key represents the new binding name as it will be referenced in the Gremlin query.  For
example, if the Gremlin Server defines two <code>TraversalSource</code> instances named <code>g1</code>, it would be possible
to send an alias pair with key of "g" and value of "g1" and thus allow the script to refer to "g1" simply as "g". Note
that unlike users of <code>alias</code> in other contexts, in this case, the key can <strong>only</strong> be set to "g" and there can be only
one key value pair present (since only one <code>Traversal</code> is being submitted, there is no sense to having more than a
single alias).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`close` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sideEffect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The unique identifier for the request that original submitted the traversal (side-effects are keyed by that value)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>'`gather` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sideEffect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The unique identifier for the request that original submitted the traversal (side-effects are keyed by that value)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sideEffectKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The key for a specific side-effect.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> A map with a single key/value pair that refers to a globally bound <code>TraversalSource</code> object
to be aliased to different variable names for purposes of the current request.  The value represents the name of the
global variable and its key represents the new binding name as it will be referenced in the Gremlin query.  For
example, if the Gremlin Server defines two <code>TraversalSource</code> instances named <code>g1</code>, it would be possible
to send an alias pair with key of "g" and value of "g1" and thus allow the script to refer to "g1" simply as "g". Note
that unlike users of <code>alias</code> in other contexts, in this case, the key can <strong>only</strong> be set to "g" and there can be only
one key value pair present (since only one <code>Traversal</code> is being submitted, there is no sense to having more than a
single alias).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When using "gather" it is important to note the metadata that is returned on the <code>ResponseMessage</code>. It returns both the
"sideEffectKey" that was requested as well as a value keyed as "aggregateTo". The "aggregateTo" field describes how the
streamed side-effect data should be treated on the client. It provides a hint as to whether or not the data should be
rolled back up into a single object or simply left as-is. There are four values for "aggregateTo": <code>bulkset</code>, <code>list</code>,
<code>map</code>, <code>set</code> and <code>none</code>.</p>
</div>
<div class="paragraph">
<p>'`keys` operation arguments'</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15.3846%;">
<col style="width: 15.3846%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sideEffect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong> The unique identifier for the request that original submitted the traversal (side-effects are keyed by that value)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_authentication">Authentication</h3>
<div class="paragraph">
<p>Gremlin Server supports <a href="https://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer">SASL-based</a>
authentication.  A SASL implementation provides a series of challenges and responses that a driver must comply with
in order to authenticate.  By default, Gremlin Server only supports the "PLAIN" SASL mechanism, which is a cleartext
password system.  When authentication is enabled, an incoming request is intercepted before it is evaluated by the
<code>ScriptEngine</code>.  The request is saved on the server and a <code>AUTHENTICATE</code> challenge response (status code <code>407</code>) is
returned to the client.</p>
</div>
<div class="paragraph">
<p>The client will detect the <code>AUTHENTICATE</code> and respond with an <code>authentication</code> for the <code>op</code> and an <code>arg</code> named <code>sasl</code>
that contains the password.  The password should be either, an encoded sequence of UTF-8 bytes, delimited by 0
(US-ASCII NUL), where the form is : <code>&lt;NUL&gt;username&lt;NUL&gt;password</code>, or a Base64 encoded string of the former (which
in this instance would be <code>AHVzZXJuYW1lAHBhc3N3b3Jk</code>).  Should Gremlin Server be able to authenticate with the
provided credentials, the server will return the results of the original request as it normally does without
authentication.  If it cannot authenticate given the challenge response from the client, it will return <code>UNAUTHORIZED</code>
(status code <code>401</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gremlin Server does not support the "authorization identity" as described in <a href="https://tools.ietf.org/html/rfc4616">RFC4616</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gremlin-plugins">Gremlin Plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="../../images/gremlin-plugin.png" alt="gremlin plugin" width="125"></span></p>
</div>
<div class="paragraph">
<p>Plugins provide a way to expand the features of a <code>GremlinScriptEngine</code>, which stands at that core of both Gremlin
Console and Gremlin Server. Providers may wish to create plugins for a variety of reasons, but some common examples
include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initialize the <code>GremlinScriptEngine</code> application with important classes so that the user doesn&#8217;t need to type their
own imports.</p>
</li>
<li>
<p>Place specific objects in the bindings of the <code>GremlinScriptEngine</code> for the convenience of the user.</p>
</li>
<li>
<p>Bootstrap the <code>GremlinScriptEngine</code> with custom functions so that they are ready for usage at startup.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first step to developing a plugin is to implement the <a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/GremlinPlugin.html">GremlinPlugin</a>
interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">
<span class="keyword">package</span> <span class="namespace">org.apache.tinkerpop.gremlin.jsr223</span>;

<span class="keyword">import</span> <span class="include">java.util.Optional</span>;

<span class="comment">/**
 * A plugin interface that is used by the {@link GremlinScriptEngineManager} to configure special {@link Customizer}
 * instances that will alter the features of any {@link GremlinScriptEngine} created by the manager itself.
 *
 * @author Stephen Mallette (http://stephen.genoprime.com)
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">GremlinPlugin</span> {
    <span class="comment">/**
     * The name of the module.  This name should be unique (use a namespaced approach) as naming clashes will
     * prevent proper module operations. Modules developed by TinkerPop will be prefixed with &quot;tinkerpop.&quot;
     * For example, TinkerPop's implementation of Giraph would be named &quot;tinkerpop.giraph&quot;.  If Facebook were
     * to do their own implementation the implementation might be called &quot;facebook.giraph&quot;.
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Some modules may require a restart of the plugin host for the classloader to pick up the features.  This is
     * typically true of modules that rely on {@code Class.forName()} to dynamically instantiate classes from the
     * root classloader (e.g. JDBC drivers that instantiate via @{code DriverManager}).
     */</span>
    <span class="directive">public</span> <span class="keyword">default</span> <span class="type">boolean</span> requireRestart() {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="comment">/**
     * Gets the list of all {@link Customizer} implementations to assign to a new {@link GremlinScriptEngine}. This is
     * the same as doing {@code getCustomizers(null)}.
     */</span>
    <span class="directive">public</span> <span class="keyword">default</span> Optional&lt;<span class="predefined-type">Customizer</span><span class="type">[]</span>&gt; getCustomizers(){
        <span class="keyword">return</span> getCustomizers(<span class="predefined-constant">null</span>);
    }

    <span class="comment">/**
     * Gets the list of {@link Customizer} implementations to assign to a new {@link GremlinScriptEngine}. The
     * implementation should filter the returned {@code Customizers} according to the supplied name of the
     * Gremlin-enabled {@code ScriptEngine}. By providing a filter, {@code GremlinModule} developers can have the
     * ability to target specific {@code ScriptEngines}.
     *
     * @param scriptEngineName The name of the {@code ScriptEngine} or null to get all the available {@code Customizers}
     */</span>
    <span class="directive">public</span> Optional&lt;<span class="predefined-type">Customizer</span><span class="type">[]</span>&gt; getCustomizers(<span class="directive">final</span> <span class="predefined-type">String</span> scriptEngineName);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most simple plugin and the one most commonly implemented will likely be one that just provides a list of classes
for import.  This type of plugin is the easiest way for implementers of the TinkerPop Structure and Process APIs to
make their implementations available to users.  The TinkerGraph implementation has just such a plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">
<span class="keyword">package</span> <span class="namespace">org.apache.tinkerpop.gremlin.tinkergraph.jsr223</span>;

<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.AbstractGremlinPlugin</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.DefaultImportCustomizer</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.jsr223.ImportCustomizer</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerGraphComputer</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerGraphComputerView</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerMapEmitter</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerMemory</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerMessenger</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerReduceEmitter</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.process.computer.TinkerWorkerPool</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerEdge</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerElement</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerFactory</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerGraph</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerGraphVariables</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerHelper</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerIoRegistryV1d0</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerIoRegistryV2d0</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerIoRegistryV3d0</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerProperty</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerVertex</span>;
<span class="keyword">import</span> <span class="include">org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerVertexProperty</span>;

<span class="comment">/**
 * @author Stephen Mallette (http://stephen.genoprime.com)
 */</span>
<span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">TinkerGraphGremlinPlugin</span> <span class="directive">extends</span> AbstractGremlinPlugin {
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> NAME = <span class="string"><span class="delimiter">&quot;</span><span class="content">tinkerpop.tinkergraph</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> ImportCustomizer imports = DefaultImportCustomizer.build()
            .addClassImports(TinkerEdge.class,
                    TinkerElement.class,
                    TinkerFactory.class,
                    TinkerGraph.class,
                    TinkerGraphVariables.class,
                    TinkerHelper.class,
                    TinkerIoRegistryV1d0.class,
                    TinkerIoRegistryV2d0.class,
                    TinkerIoRegistryV3d0.class,
                    TinkerProperty.class,
                    TinkerVertex.class,
                    TinkerVertexProperty.class,
                    TinkerGraphComputer.class,
                    TinkerGraphComputerView.class,
                    TinkerMapEmitter.class,
                    TinkerMemory.class,
                    TinkerMessenger.class,
                    TinkerReduceEmitter.class,
                    TinkerWorkerPool.class).create();

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> TinkerGraphGremlinPlugin instance = <span class="keyword">new</span> TinkerGraphGremlinPlugin();

    <span class="directive">public</span> TinkerGraphGremlinPlugin() {
        <span class="local-variable">super</span>(NAME, imports);
    }

    <span class="directive">public</span> <span class="directive">static</span> TinkerGraphGremlinPlugin instance() {
        <span class="keyword">return</span> instance;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This plugin extends from the abstract base class of <a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/AbstractGremlinPlugin.html">AbstractGremlinPlugin</a>
which provides some default implementations of the <code>GremlinPlugin</code> methods. It simply allows those who extend from it
to be able to just supply the name of the module and a list of <a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/Customizer.html">Customizer</a>
instances to apply to the <code>GremlinScriptEngine</code>. In this case, the TinkerGraph plugin just needs an
<a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/ImportCustomizer.html">ImportCustomizer</a>
which describes the list of classes to import when the plugin is activated and applied to the <code>GremlinScriptEngine</code>.</p>
</div>
<div class="paragraph">
<p>The <code>ImportCustomizer</code> is just one of several provided <code>Customizer</code> implementations that can be used in conjunction
with plugin development:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/BindingCustomizer.html">BindingCustomizer</a> - Inject a key/value pair into the global bindings of the <code>GremlinScriptEngine</code> instances</p>
</li>
<li>
<p><a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/ImportCustomizer.html">ImportCustomizer</a> - Add imports to a <code>GremlinScriptEngine</code></p>
</li>
<li>
<p><a href="http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/ScriptCustomizer.html">ScriptCustomizer</a> - Execute a script on a <code>GremlinScriptEngine</code> at startup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Individual <code>GremlinScriptEngine</code> instances may have their own <code>Customizer</code> instances that can be used only with that
engine - e.g. <code>gremlin-groovy</code> has some that are specific to controlling the Groovy compiler configuration. Developing
a new <code>Customizer</code> implementation is not really possible without changes to TinkerPop, as the framework is not designed
to respond to external ones. The base <code>Customizer</code> implementations listed above should cover most needs.</p>
</div>
<div class="paragraph">
<p>A <code>GremlinPlugin</code> must support one of two instantiation models so that it can be instantiated from configuration files
for use in various situations - e.g. Gremlin Server. The first option is to use a static initializer given a method
with the following signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> GremlinPlugin instance()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The limitation with this approach is that it does not provide a way to supply any configuration to the plugin so it
tends to only be useful for fairly simplistic plugins. The more advanced approach is to provide a "builder" given a
method with the following signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> Builder build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>It doesn&#8217;t really matter what kind of class is returned from <code>build</code> so long as it follows a "Builder" pattern, where
methods on that object return an instance of itself, so that builder methods can be chained together prior to calling
a final <code>create</code> method as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> GremlinPlugin create()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please see the link:http://tinkerpop.apache.org/javadocs/3.3.1/full/org/apache/tinkerpop/gremlin/jsr223/ImportGremlinPlugin.html
for an example of what implementing a <code>Builder</code> might look like in this context.</p>
</div>
<div class="paragraph">
<p>Note that the plugin provides a unique name for the plugin which follows a namespaced pattern as <em>namespace</em>.<em>plugin-name</em>
(e.g. "tinkerpop.hadoop" - "tinkerpop" is the reserved namespace for TinkerPop maintained plugins).</p>
</div>
<div class="paragraph">
<p>For plugins that will work with Gremlin Console, there is one other step to follow to ensure that the <code>GremlinPlugin</code>
will work there.  The console loads <code>GremlinPlugin</code> instances via <a href="http://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">ServiceLoader</a>
and therefore need a resource file added to the jar file where the plugin exists.  Add a file called
<code>org.apache.tinkerpop.gremlin.jsr223.GremlinPlugin</code> to <code>META-INF/services</code>.  In the case of the TinkerGraph
plugin above, that file will have this line in it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the plugin is packaged, there are two ways to test it out:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copy the jar and its dependencies to the Gremlin Console path and start it. It is preferrable that the plugin is
copied to the <code>/ext/<em>plugin_name</em></code> directory.</p>
</li>
<li>
<p>Start Gremlin Console and try the <code>:install</code> command: <code>:install com.company my-plugin 1.0.0</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In either case, once one of these two approaches is taken, the jars and their dependencies are available to the
Console.  The next step is to "activate" the plugin by doing <code>:plugin use my-plugin</code>, where "my-plugin" refers to the
name of the plugin to activate.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When <code>:install</code> is used logging dependencies related to <a href="http://www.slf4j.org/">SLF4J</a> are filtered out so as
not to introduce multiple logger bindings (which generates warning messages to the logs).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A plugin can do much more than just import classes.  One can expand the Gremlin language with new functions or steps,
provide useful commands to make repetitive or complex tasks easier to execute, or do helpful integrations with other
systems.  The secret to doing so lies in the <code>PluginAcceptor</code>.  As mentioned earlier, the <code>PluginAcceptor</code> provides
access to the host of the plugin.  It provides several important methods for doing so:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>addBinding</code> - These two function allow the plugin to inject whatever context it wants to the host.  For example,
doing <code>addBinding('x',1)</code> would place a variable of <code>x</code> with a value of 1 into the console at the time of the plugin load.</p>
</li>
<li>
<p><code>eval</code> - Evaluates a script in the context of the host at the time of plugin startup.  For example, doing
<code>eval("sum={x,y&#8594;x+y}")</code> would create a <code>sum</code> function that would be available to the user of the Console after the
load of the plugin.</p>
</li>
<li>
<p><code>environment</code> - Provides context from the host environment.  For the console, the environment will return a <code>Map</code>
containing a reference to the <code>IO</code> stream and the <code>Groovysh</code> instance.  These classes represent very low-level access
to the underpinnings of the console.  Access to <code>Groovysh</code> allows for advanced features such as registering new
commands (e.g. like the <code>:plugin</code> or <code>:remote</code> commands).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Plugins can also tie into the <code>:remote</code> and <code>:submit</code> commands.  Recall that a <code>:remote</code> represents a different
context within which Gremlin is executed, when issued with <code>:submit</code>.  It is encouraged to use this integration point
when possible, as opposed to registering new commands that can otherwise follow the <code>:remote</code> and <code>:submit</code> pattern.
To expose this integration point as part of a plugin, implement the <code>RemoteAcceptor</code> interface:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Be good to the users of plugins and prevent dependency conflicts. Maintaining a conflict free plugin is most
easily done by using the <a href="http://maven.apache.org/enforcer/maven-enforcer-plugin/">Maven Enforcer Plugin</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Consider binding the plugin&#8217;s minor version to the TinkerPop minor version so that it&#8217;s easy for users to figure
out plugin compatibility.  Otherwise, clearly document a compatibility matrix for the plugin somewhere that users can
find it.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">
<span class="keyword">package</span> <span class="namespace">org.apache.tinkerpop.gremlin.jsr223.console</span>;

<span class="keyword">import</span> <span class="include">java.io.Closeable</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="comment">/**
 * The Gremlin Console supports the {@code :remote} and {@code :submit} commands which provide standardized ways
 * for plugins to provide &quot;remote connections&quot; to resources and a way to &quot;submit&quot; a command to those resources.
 * A &quot;remote connection&quot; does not necessarily have to be a remote server.  It simply refers to a resource that is
 * external to the console.
 * &lt;p/&gt;
 * By implementing this interface and returning an instance of it through
 * {@link ConsoleCustomizer#getRemoteAcceptor(GremlinShellEnvironment)} a plugin can hook into those commands and
 * provide remoting features.
 *
 * @author Stephen Mallette (http://stephen.genoprime.com)
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">RemoteAcceptor</span> <span class="directive">extends</span> <span class="predefined-type">Closeable</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> RESULT = <span class="string"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * Gets called when {@code :remote} is used in conjunction with the &quot;connect&quot; option.  It is up to the
     * implementation to decide how additional arguments on the line should be treated after &quot;connect&quot;.
     *
     * @return an object to display as output to the user
     * @throws RemoteException if there is a problem with connecting
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> connect(<span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; args) <span class="directive">throws</span> <span class="exception">RemoteException</span>;

    <span class="comment">/**
     * Gets called when {@code :remote} is used in conjunction with the {@code config} option.  It is up to the
     * implementation to decide how additional arguments on the line should be treated after {@code config}.
     *
     * @return an object to display as output to the user
     * @throws RemoteException if there is a problem with configuration
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> configure(<span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; args) <span class="directive">throws</span> <span class="exception">RemoteException</span>;

    <span class="comment">/**
     * Gets called when {@code :submit} is executed.  It is up to the implementation to decide how additional
     * arguments on the line should be treated after {@code :submit}.
     *
     * @return an object to display as output to the user
     * @throws RemoteException if there is a problem with submission
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> submit(<span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; args) <span class="directive">throws</span> <span class="exception">RemoteException</span>;

    <span class="comment">/**
     * If the {@code RemoteAcceptor} is used in the Gremlin Console, then this method might be called to determine
     * if it can be used in a fashion that supports the {@code :remote console} command.  By default, this value is
     * set to {@code false}.
     * &lt;p/&gt;
     * A {@code RemoteAcceptor} should only return {@code true} for this method if it expects that all activities it
     * supports are executed through the {@code :sumbit} command. If the users interaction with the remote requires
     * working with both local and remote evaluation at the same time, it is likely best to keep this method return
     * {@code false}. A good example of this type of plugin would be the Gephi Plugin which uses {@code :remote config}
     * to configure a local {@code TraversalSource} to be used and expects calls to {@code :submit} for the same body
     * of analysis.
     */</span>
    <span class="directive">public</span> <span class="keyword">default</span> <span class="type">boolean</span> allowRemoteConsole() {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>RemoteAcceptor</code> can be bound to a <code>GremlinPlugin</code> by adding a <code>ConsoleCustomizer</code> implementation to the list of
<code>Customizer</code> instances that are returned from the <code>GremlinPlugin</code>. The <code>ConsoleCustomizer</code> will only be executed when
in use with the Gremlin Console plugin host.  Simply instantiate and return a <code>RemoteAcceptor</code> in the
<code>ConsoleCustomizer.getRemoteAcceptor(GremlinShellEnvironment)</code> method.  Generally speaking, each call to
<code>getRemoteAcceptor(GremlinShellEnvironment)</code> should produce a new instance of a <code>RemoteAcceptor</code>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-12-17 10:21:13 EST
</div>
</div>
</body>
</html>
